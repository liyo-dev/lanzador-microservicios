<h1>Configuración de Microservicios</h1>

<div class="tab-selector">
  <button [class.active]="selectedTab === 'angular'" (click)="changeTab('angular')">Angular</button>
  <button [class.active]="selectedTab === 'spring'" (click)="changeTab('spring')">Spring</button>
</div>

<div class="section" *ngIf="!loading && selectedTab === 'angular'">
  <div class="micro-grid">
    <div *ngFor="let micro of angularMicros" class="micro-card">
      <h3>{{ micro.label }}</h3>
      <input [(ngModel)]="config.angular[micro.key].path" type="text" placeholder="Ruta del microservicio" />
      <input [(ngModel)]="config.angular[micro.key].port" type="number" placeholder="Puerto" />
    </div>
  </div>
</div>

<div class="section" *ngIf="!loading && selectedTab === 'spring'">
  <div class="spring-settings">
    <fieldset>
      <legend>Configuración general de entorno</legend>
      <label>
        JAVA_HOME:
        <input [(ngModel)]="config.spring.javaHome" type="text" placeholder="Ej: C:\Java\jdk1.8.0_211" />
        <button type="button" class="browse-btn" (click)="browseFolder($event)">📁</button>
      </label>
      <label>
        MAVEN_HOME:
        <input [(ngModel)]="config.spring.mavenHome" type="text" placeholder="Ej: C:\Herramientas\apache-maven-3.8.6" />
        <button type="button" class="browse-btn" (click)="browseFolder($event)">📁</button>
      </label>
      <label>
        settings.xml:
        <input [(ngModel)]="config.spring.settingsXml" type="text" placeholder="Ej: C:\.m2\settings.xml" />
        <button type="button" class="browse-btn" (click)="browseFolder($event)">📁</button>
      </label>
      <label>
        Repositorio .m2:
        <input [(ngModel)]="config.spring.m2RepoPath" type="text" placeholder="Ej: C:\Users\usuario\.m2\repository" />
        <button type="button" class="browse-btn" (click)="browseFolder($event)">📁</button>
      </label>
    </fieldset>
  </div>
  <div class="micro-grid">
    <div *ngFor="let micro of springMicros" class="micro-card">
      <h3>{{ micro.label }}</h3>
      <input [(ngModel)]="config.spring[micro.key].path" type="text" placeholder="Ruta del microservicio" />
    </div>
  </div>
</div>

<div class="button-bar">
  <button class="save-btn" (click)="goToHome()">🏠 Home</button>
  <button class="save-btn" (click)="save()">💾 Guardar</button>
  <button class="clear-btn" (click)="clear()">🗑 Borrar</button>
  <button class="go-btn" (click)="goToLauncher()">🚀 Ir al launcher</button>
</div>

<div class="feedback-zone">
  <div *ngIf="guardadoOK" class="msg msg-guardar">✅ Configuración guardada correctamente.</div>
  <div *ngIf="borradoOK" class="msg msg-borrar">🗑️ Configuración eliminada.</div>
</div>

<app-spinner *ngIf="loading"></app-spinner>